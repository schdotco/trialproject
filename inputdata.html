<!DOCTYPE html>
<html>
<head>
  <title>Input Data Kesehatan</title>
</head>
<body>

<h2>Input Data Agregat Kesehatan</h2>

<h3>Ibu Hamil</h3>
<input id="ihNormal" type="number" placeholder="Normal">
<input id="ihRisti" type="number" placeholder="Resiko Tinggi">

<h3>Balita</h3>
<input id="bNormal" type="number" placeholder="Normal">
<input id="bStunting" type="number" placeholder="Stunting">
<input id="bGizi" type="number" placeholder="Gizi Buruk">

<h3>Lainnya</h3>
<input id="disabilitas" type="number" placeholder="Disabilitas">
<input id="tbPengobatan" type="number" placeholder="TB Dalam Pengobatan">
<input id="tbTotal" type="number" placeholder="Jumlah TB Terdeteksi">

<h3>Lansia</h3>
<input id="lMandiri" type="number" placeholder="Mandiri">
<input id="lB" type="number" placeholder="Kategori B">
<input id="lC" type="number" placeholder="Kategori C">

<h3>Sanitasi</h3>
<input id="odf" type="number" placeholder="ODF (0/1)">

<br><br>
<button id="btnSimpan">Simpan Data</button>

<script type="module">
import { db } from "./firebase.js";
import { collection, addDoc, serverTimestamp }
from "https://www.gstatic.com/firebasejs/10.7.0/firebase-firestore.js";

document.getElementById("btnSimpan").addEventListener("click", async () => {
  try {
    await addDoc(collection(db, "kesehatan_agregat"), {
      ibuHamilNormal: +ihNormal.value || 0,
      ibuHamilRisti: +ihRisti.value || 0,

      balitaNormal: +bNormal.value || 0,
      balitaStunting: +bStunting.value || 0,
      balitaGiziBuruk: +bGizi.value || 0,

      disabilitas: +disabilitas.value || 0,

      tbPengobatan: +tbPengobatan.value || 0,
      tbTotal: +tbTotal.value || 0,

      lansiaMandiri: +lMandiri.value || 0,
      lansiaB: +lB.value || 0,
      lansiaC: +lC.value || 0,

      odf: +odf.value || 0,
      createdAt: serverTimestamp()
    });

    alert("Data berhasil disimpan");
    window.location.href = "dashboard.html";

  } catch (err) {
    alert("Gagal simpan data");
    console.error(err);
  }
});
</script>

</body>
</html>
