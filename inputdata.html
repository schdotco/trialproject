<!DOCTYPE html>
<html lang="id">
<head>
  <meta charset="UTF-8">
  <title>Input Data Kesehatan</title>
</head>
<body>

<h2>Input Data Agregat Kesehatan</h2>

<h3>Ibu Hamil</h3>
<input id="ihNormal" type="number" placeholder="Ibu Hamil Normal">
<input id="ihRisti" type="number" placeholder="Ibu Hamil Risiko Tinggi">

<h3>Balita</h3>
<input id="bNormal" type="number" placeholder="Balita Normal">
<input id="bStunting" type="number" placeholder="Balita Stunting">
<input id="bGizi" type="number" placeholder="Balita Gizi Buruk">

<h3>Lainnya</h3>
<input id="disabilitas" type="number" placeholder="Disabilitas">
<input id="tbPengobatan" type="number" placeholder="TB Dalam Pengobatan">
<input id="tbTotal" type="number" placeholder="Jumlah TB Terdeteksi">

<h3>Lansia</h3>
<input id="lMandiri" type="number" placeholder="Lansia Mandiri">
<input id="lB" type="number" placeholder="Lansia Kategori B">
<input id="lC" type="number" placeholder="Lansia Kategori C">

<h3>Sanitasi</h3>
<input id="odf" type="number" placeholder="ODF (0 / 1)">

<br><br>
<button id="btnSimpan">Simpan Data</button>

<!-- SCRIPT MODULE -->
<script type="module">
  // üîó import Firestore dari firebase.js (FINAL)
  import { db } from "./firebase.js";

  // üîó import fungsi Firestore
  import {
    collection,
    addDoc,
    serverTimestamp
  } from "https://www.gstatic.com/firebasejs/10.7.0/firebase-firestore.js";

  // üéØ Event simpan data
  document.getElementById("btnSimpan").addEventListener("click", async () => {
    try {
      await addDoc(collection(db, "kesehatan_agregat"), {
        ibuHamilNormal: Number(ihNormal.value) || 0,
        ibuHamilRisti: Number(ihRisti.value) || 0,

        balitaNormal: Number(bNormal.value) || 0,
        balitaStunting: Number(bStunting.value) || 0,
        balitaGiziBuruk: Number(bGizi.value) || 0,

        disabilitas: Number(disabilitas.value) || 0,

        tbPengobatan: Number(tbPengobatan.value) || 0,
        tbTotal: Number(tbTotal.value) || 0,

        lansiaMandiri: Number(lMandiri.value) || 0,
        lansiaB: Number(lB.value) || 0,
        lansiaC: Number(lC.value) || 0,

        odf: Number(odf.value) || 0,

        createdAt: serverTimestamp()
      });

      alert("‚úÖ Data berhasil disimpan");
      window.location.href = "dashboard.html";

    } catch (error) {
      console.error("‚ùå Error simpan Firestore:", error);
      alert("‚ùå Gagal menyimpan data, cek console");
    }
  });
</script>

</body>
</html>
