<!DOCTYPE html>
<html>
<head>
  <title>Dashboard Data Kesehatan</title>
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
  <style>
    body { font-family: Arial; padding: 16px; }
    .box { padding: 10px; margin: 6px 0; background: #f2f2f2; }
  </style>
</head>
<body>

<h2>Dashboard Data Kesehatan</h2>

<div id="ringkasan">Memuat data...</div>

<canvas id="grafik" height="120"></canvas>

<script>
const API = "PASTE_WEB_APP_URL_KAMU_DI_SINI";

fetch(API)
  .then(res => {
    if (!res.ok) throw new Error("API tidak bisa diakses");
    return res.json();
  })
  .then(data => {
    if (!data || data.length === 0) {
      ringkasan.innerHTML = "Belum ada data";
      return;
    }

    const d = data[data.length - 1];

    const ibuHamilTotal = (+d[1] || 0) + (+d[2] || 0);
    const balitaTotal = (+d[3] || 0) + (+d[4] || 0) + (+d[5] || 0);
    const lansiaTotal = (+d[9] || 0) + (+d[10] || 0) + (+d[11] || 0);

    ringkasan.innerHTML = `
      <div class="box"><b>Ibu Hamil</b><br>
        Normal: ${d[1]} | Risti: ${d[2]} | Total: ${ibuHamilTotal}
      </div>

      <div class="box"><b>Balita</b><br>
        Normal: ${d[3]} | Stunting: ${d[4]} | Gizi Buruk: ${d[5]} | Total: ${balitaTotal}
      </div>

      <div class="box"><b>Lainnya</b><br>
        Disabilitas: ${d[6]}<br>
        TB Dalam Pengobatan: ${d[7]}<br>
        TB Terdeteksi: ${d[8]}
      </div>

      <div class="box"><b>Lansia</b><br>
        Mandiri: ${d[9]} | B: ${d[10]} | C: ${d[11]} | Total: ${lansiaTotal}
      </div>

      <div class="box"><b>ODF</b>: ${d[12]}</div>
    `;

    const grafik = document.getElementById("grafik");

    new Chart(grafik, {
      type: "bar",
      data: {
        labels: ["Ibu Hamil", "Balita", "TB", "Lansia", "ODF"],
        datasets: [{
          label: "Jumlah",
          data: [
            ibuHamilTotal,
            balitaTotal,
            d[8],
            lansiaTotal,
            d[12]
          ]
        }]
      }
    });
  })
  .catch(err => {
    ringkasan.innerHTML = "‚ùå Gagal memuat data<br>" + err.message;
    console.error(err);
  });
</script>

</body>
</html>
